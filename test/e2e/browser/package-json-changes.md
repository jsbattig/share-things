# Package.json Changes for E2E Browser Testing

This document outlines the changes needed in the project's `package.json` file to support E2E browser testing with Playwright.

## Dependencies to Add

Add the following development dependencies to your project:

```json
{
  "devDependencies": {
    "@playwright/test": "^1.40.0",
    "wait-on": "^7.0.1",
    "concurrently": "^8.2.0",
    "cross-env": "^7.0.3"
  }
}
```

You can add these dependencies by running:

```bash
npm install --save-dev @playwright/test wait-on concurrently cross-env
```

## Scripts to Add

Add the following scripts to your `package.json` file:

```json
{
  "scripts": {
    "test:e2e:browser": "playwright test --config=test/e2e/browser/playwright.config.ts",
    "test:e2e:browser:ui": "playwright test --config=test/e2e/browser/playwright.config.ts --ui",
    "test:e2e:browser:debug": "playwright test --config=test/e2e/browser/playwright.config.ts --debug",
    "test:e2e:browser:report": "playwright show-report",
    "test:e2e:browser:ci": "cross-env CI=true playwright test --config=test/e2e/browser/playwright.config.ts --headless",
    "test:e2e:browser:install": "playwright install --with-deps"
  }
}
```

## Complete Example

Here's a complete example of what your `package.json` file might look like after adding the E2E browser testing configuration:

```json
{
  "name": "share-things",
  "version": "1.0.0",
  "description": "Real-time content sharing application with end-to-end encryption",
  "main": "index.js",
  "scripts": {
    "start": "concurrently \"cd server && npm run dev\" \"cd client && npm run dev\"",
    "test": "jest",
    "test:e2e": "jest --config=jest.config.js test/e2e/functional/functional-tests.test.ts",
    "test:e2e:simple": "jest --config=jest.config.js test/e2e/functional/simple-test.test.ts",
    "test:all": "concurrently \"cd server && npm test\" \"cd client && npm test\" \"npm run test:e2e\"",
    "test:watch": "jest --watch",
    "build": "concurrently \"cd server && npm run build\" \"cd client && npm run build\"",
    "test:e2e:browser": "playwright test --config=test/e2e/browser/playwright.config.ts",
    "test:e2e:browser:ui": "playwright test --config=test/e2e/browser/playwright.config.ts --ui",
    "test:e2e:browser:debug": "playwright test --config=test/e2e/browser/playwright.config.ts --debug",
    "test:e2e:browser:report": "playwright show-report",
    "test:e2e:browser:ci": "cross-env CI=true playwright test --config=test/e2e/browser/playwright.config.ts --headless",
    "test:e2e:browser:install": "playwright install --with-deps"
  },
  "keywords": [
    "sharing",
    "encryption",
    "websockets",
    "real-time"
  ],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "@playwright/test": "^1.40.0",
    "@types/express": "^5.0.1",
    "@types/jest": "^29.5.0",
    "@types/jsdom": "^21.1.0",
    "@types/node": "^18.15.11",
    "@types/socket.io-client": "^3.0.0",
    "@types/uuid": "^9.0.1",
    "concurrently": "^8.2.0",
    "cross-env": "^7.0.3",
    "express": "^5.1.0",
    "jest": "^29.5.0",
    "jsdom": "^21.1.1",
    "socket.io": "^4.8.1",
    "socket.io-client": "^4.8.1",
    "ts-jest": "^29.1.0",
    "typescript": "^5.0.4",
    "uuid": "^9.0.0",
    "wait-on": "^7.0.1"
  }
}
```

## Script Descriptions

Here's what each script does:

1. **test:e2e:browser**: Runs all E2E browser tests using Playwright.
   ```bash
   npm run test:e2e:browser
   ```

2. **test:e2e:browser:ui**: Runs tests with the Playwright UI, which provides a visual interface for debugging.
   ```bash
   npm run test:e2e:browser:ui
   ```

3. **test:e2e:browser:debug**: Runs tests in debug mode, which pauses execution and allows step-by-step debugging.
   ```bash
   npm run test:e2e:browser:debug
   ```

4. **test:e2e:browser:report**: Shows the HTML report generated by Playwright after running tests.
   ```bash
   npm run test:e2e:browser:report
   ```

5. **test:e2e:browser:ci**: Runs tests in CI mode, which uses headless browsers and is optimized for continuous integration environments.
   ```bash
   npm run test:e2e:browser:ci
   ```

6. **test:e2e:browser:install**: Installs Playwright browsers and dependencies.
   ```bash
   npm run test:e2e:browser:install
   ```

## Running Specific Tests

You can run specific tests by adding additional arguments to the test command:

```bash
# Run tests matching a specific title
npm run test:e2e:browser -- --grep "text sharing"

# Run tests in a specific file
npm run test:e2e:browser -- tests/sharing.test.ts

# Run tests on specific browsers
npm run test:e2e:browser -- --project=chromium

# Run tests with specific workers
npm run test:e2e:browser -- --workers=4
```

## Initial Setup

After updating your `package.json`, run the following commands to set up the E2E browser testing environment:

```bash
# Install dependencies
npm install

# Install Playwright browsers
npm run test:e2e:browser:install

# Create directory structure
mkdir -p test/e2e/browser/fixtures
mkdir -p test/e2e/browser/helpers
mkdir -p test/e2e/browser/tests

# Create test fixtures
# (Add sample files to the fixtures directory)
```

## Next Steps

After updating your `package.json` and installing the dependencies, you can proceed with:

1. Creating the Playwright configuration file (`playwright.config.ts`)
2. Implementing the helper functions (`app-launcher.ts`, `browser-utils.ts`)
3. Writing test cases in the `tests` directory
4. Running the tests using the new scripts

For detailed implementation instructions, refer to the other documentation files in this directory.